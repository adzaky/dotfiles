# GRUB boot loader configuration

if cat /proc/cpuinfo | grep -i ryzen > /dev/null 2>&1; then
  # Specific kernel fix for Ryzen
  ZEN_CMDLINE="idle=nomwait processor.max_cstate=5"
fi

MTBUG="nopti nospectre_v2 spectre_v2_user=off spec_store_bypass_disable=off l1tf=off mitigations=off"
GRUB_DEFAULT=0
GRUB_TIMEOUT=5
GRUB_DISTRIBUTOR="Arch"
GRUB_CMDLINE_LINUX_DEFAULT="$ZEN_CMDLINE"
GRUB_CMDLINE_LINUX=""

# Preload both GPT and MBR modules so that they are not missed
GRUB_PRELOAD_MODULES="part_gpt part_msdos"

# Uncomment to use basic console
GRUB_TERMINAL_INPUT=console

# The resolution used on graphical terminal
# note that you can use only modes which your graphic card supports via VBE
# you can see them in real GRUB with the command `vbeinfo'
GRUB_GFXMODE=auto

# Uncomment to allow the kernel use the same resolution used by grub
GRUB_GFXPAYLOAD_LINUX=keep

# Uncomment and set to the desired menu colors.  Used by normal and wallpaper
# modes only.  Entries specified as foreground/background.
GRUB_COLOR_NORMAL="red/black"
GRUB_COLOR_HIGHLIGHT="black/red"
